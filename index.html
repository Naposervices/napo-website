<!DOCTYPE html>
<html lang="de">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Naposervices - Premium Katalog</title>
    <meta name="description" content="Naposervices - Dein Shop f√ºr Premium Fashion und Sneakers">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            background-color: #0a0a0a;
            color: white;
        }

        /* Glassmorphism */
        .glass {
            background: rgba(17, 24, 39, 0.7);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(55, 65, 81, 0.3);
        }

        /* Grid Pattern */
        .bg-grid-pattern {
            background-image:
                linear-gradient(rgba(6, 182, 212, 0.05) 1px, transparent 1px),
                linear-gradient(90deg, rgba(6, 182, 212, 0.05) 1px, transparent 1px);
            background-size: 50px 50px;
        }

        /* Loading Animation */
        .loading-spinner {
            border: 3px solid rgba(6, 182, 212, 0.2);
            border-top: 3px solid #06b6d4;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        /* Image Lazy Load Effect */
        img {
            transition: opacity 0.3s ease-in-out;
        }

        img[data-loading="true"] {
            opacity: 0;
        }

        img[data-loading="false"] {
            opacity: 1;
        }

        /* Skeleton Loader */
        .skeleton {
            background: linear-gradient(90deg, #1f2937 25%, #374151 50%, #1f2937 75%);
            background-size: 200% 100%;
            animation: loading 1.5s ease-in-out infinite;
        }

        @keyframes loading {
            0% {
                background-position: 200% 0;
            }

            100% {
                background-position: -200% 0;
            }
        }

        /* Smooth Scroll */
        html {
            scroll-behavior: smooth;
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 10px;
        }

        ::-webkit-scrollbar-track {
            background: #1f2937;
        }

        ::-webkit-scrollbar-thumb {
            background: linear-gradient(to bottom, #06b6d4, #8b5cf6);
            border-radius: 5px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(to bottom, #0891b2, #7c3aed);
        }

        /* Hover Effects */
        .hover-glow:hover {
            box-shadow: 0 0 30px rgba(6, 182, 212, 0.3);
        }

        /* Image Container */
        .image-container {
            position: relative;
            overflow: hidden;
            background: #1f2937;
        }

        .image-container::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 40px;
            height: 40px;
            border: 3px solid rgba(6, 182, 212, 0.2);
            border-top-color: #06b6d4;
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .image-container.loading::before {
            opacity: 1;
        }
    </style>
</head>

<body>
    <!-- Header -->
    <header class="sticky top-0 z-50 glass shadow-lg">
        <div class="container mx-auto px-4 py-4">
            <div class="flex justify-between items-center">
                <div class="flex items-center cursor-pointer group" onclick="showView('home')">
                    <div
                        class="bg-gradient-to-br from-cyan-500 to-purple-500 p-2 rounded-xl mr-3 group-hover:scale-110 transition-transform shadow-lg shadow-cyan-500/50">
                        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"></path>
                        </svg>
                    </div>
                    <h1
                        class="text-2xl font-black bg-gradient-to-r from-cyan-400 to-purple-400 bg-clip-text text-transparent">
                        NAPOSERVICES
                    </h1>
                </div>

                <nav class="flex gap-6 items-center">
                    <div id="statsInfo" class="text-sm text-gray-400 hidden md:block"></div>
                    <button onclick="showView('home')"
                        class="font-bold text-gray-400 hover:text-cyan-400 transition-colors">
                        Home
                    </button>
                </nav>
            </div>
        </div>
    </header>

    <!-- Loading Screen -->
    <div id="loadingScreen" class="fixed inset-0 bg-gray-900 flex items-center justify-center z-50">
        <div class="text-center">
            <div class="loading-spinner mx-auto mb-4"></div>
            <p class="text-xl text-gray-300 mb-2">Lade Katalog...</p>
            <p class="text-sm text-gray-500">Bitte warten</p>
        </div>
    </div>

    <!-- Main Content -->
    <main class="container mx-auto px-4 py-8" id="mainContent"></main>

    <!-- Gallery Modal -->
    <div id="galleryModal" class="fixed inset-0 bg-black/95 backdrop-blur-sm z-50 hidden items-center justify-center">
        <button onclick="closeGallery()"
            class="absolute top-6 right-6 text-gray-400 hover:text-white z-10 glass p-3 rounded-full hover:bg-gray-700 transition-all">
            <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
            </svg>
        </button>

        <button onclick="prevImage()"
            class="absolute left-6 text-gray-400 hover:text-white z-10 glass p-4 rounded-full hover:bg-gray-700 transition-all">
            <svg class="w-10 h-10" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
            </svg>
        </button>

        <button onclick="nextImage()"
            class="absolute right-6 text-gray-400 hover:text-white z-10 glass p-4 rounded-full hover:bg-gray-700 transition-all">
            <svg class="w-10 h-10" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
            </svg>
        </button>

        <div class="max-w-7xl max-h-[90vh] w-full flex flex-col items-center px-4" id="galleryContent"></div>
    </div>

    <!-- Toast Notification -->
    <div id="toast"
        class="fixed bottom-6 right-6 glass px-6 py-4 rounded-xl shadow-2xl transform translate-y-32 transition-transform duration-300 z-50">
        <p id="toastMessage" class="text-white"></p>
    </div>

    <script>
        let catalogData = null;
        let currentState = {
            view: 'home',
            selectedMainCategory: null,
            selectedBrand: null,
            selectedProduct: null,
            currentImageIndex: 0,
            productsPerPage: 20, // Zeige nur 20 Produkte initial
            currentPage: 1
        };

        // Image Lazy Loading with Cache
        const imageCache = new Set();

        function loadImage(img) {
            return new Promise((resolve, reject) => {
                if (imageCache.has(img.src)) {
                    img.setAttribute('data-loading', 'false');
                    // Entferne Placeholder
                    const placeholder = img.previousElementSibling;
                    if (placeholder && placeholder.classList.contains('animate-pulse')) {
                        placeholder.style.opacity = '0';
                        setTimeout(() => placeholder.remove(), 300);
                    }
                    resolve();
                    return;
                }

                img.setAttribute('data-loading', 'true');

                const tempImg = new Image();
                tempImg.onload = () => {
                    imageCache.add(img.src);
                    img.setAttribute('data-loading', 'false');
                    // Entferne Placeholder mit Fade-Out
                    const placeholder = img.previousElementSibling;
                    if (placeholder && placeholder.classList.contains('animate-pulse')) {
                        placeholder.style.transition = 'opacity 0.3s';
                        placeholder.style.opacity = '0';
                        setTimeout(() => placeholder.remove(), 300);
                    }
                    resolve();
                };
                tempImg.onerror = reject;
                tempImg.src = img.src;
            });
        }

        // Intersection Observer for Lazy Loading (optimiert mit requestAnimationFrame)
        const imageObserver = new IntersectionObserver((entries, observer) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    const img = entry.target;
                    // Verwende requestAnimationFrame f√ºr bessere Performance
                    requestAnimationFrame(() => {
                        loadImage(img);
                        observer.unobserve(img);
                    });
                }
            });
        }, {
            rootMargin: '100px', // Erh√∂ht f√ºr fr√ºheres Laden
            threshold: 0.01
        });

        // Toast Notification
        function showToast(message, duration = 3000) {
            const toast = document.getElementById('toast');
            const toastMessage = document.getElementById('toastMessage');
            toastMessage.textContent = message;
            toast.style.transform = 'translateY(0)';

            setTimeout(() => {
                toast.style.transform = 'translateY(8rem)';
            }, duration);
        }

        // Load Catalog with Performance Optimizations
        async function loadCatalog() {
            const loadingScreen = document.getElementById('loadingScreen');

            // Update loading status
            function updateLoadingStatus(message, progress = 0) {
                loadingScreen.innerHTML = `
                    <div class="text-center">
                        <div class="loading-spinner mx-auto mb-4"></div>
                        <p class="text-xl text-gray-300 mb-2">${message}</p>
                        <div class="w-64 h-2 bg-gray-700 rounded-full mx-auto mb-2 overflow-hidden">
                            <div class="h-full bg-gradient-to-r from-cyan-500 to-purple-500 transition-all duration-300" style="width: ${progress}%"></div>
                        </div>
                        <p class="text-sm text-gray-500">${progress}%</p>
                    </div>
                `;
            }

            try {
                console.log('üöÄ Starte Katalog-Laden...');
                updateLoadingStatus('Verbinde mit Server...', 10);

                // Timeout nach 30 Sekunden (erh√∂ht f√ºr gro√üe Dateien)
                const controller = new AbortController();
                const timeoutId = setTimeout(() => controller.abort(), 30000);

                updateLoadingStatus('Lade Daten...', 30);

                const response = await fetch('https://pub-4fa24bef94db4dc894899957b77a4db3.r2.dev/catalog_master.min.json', {
                    signal: controller.signal,
                    cache: 'default' // Nutzt Browser-Cache
                });
                clearTimeout(timeoutId);

                console.log('‚úì Response erhalten:', response.status, response.statusText);

                // Content-Type Check
                const contentType = response.headers.get('content-type');
                if (contentType && !contentType.includes('application/json')) {
                    console.warn('‚ö†Ô∏è Warnung: Content-Type ist nicht application/json:', contentType);
                }

                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }

                updateLoadingStatus('Verarbeite JSON...', 60);
                console.log('üì¶ Parse JSON...');

                catalogData = await response.json();

                // Validierung
                if (!catalogData || !catalogData.categories) {
                    throw new Error('Ung√ºltige Katalog-Struktur: categories fehlt');
                }

                updateLoadingStatus('Initialisiere Katalog...', 90);
                console.log('‚úì Katalog geladen!', {
                    produkte: catalogData.statistics?.total_products || 0,
                    marken: catalogData.statistics?.total_brands || 0,
                    kategorien: Object.keys(catalogData.categories || {}).length
                });

                // Smooth transition
                updateLoadingStatus('Fertig!', 100);

                requestAnimationFrame(() => {
                    loadingScreen.style.display = 'none';
                    updateStatsInfo();
                    render();
                    showToast('‚úì Katalog erfolgreich geladen!');
                });

            } catch (e) {
                console.error('‚ùå Fehler beim Laden:', e);
                console.error('Stack:', e.stack);

                let errorMsg = e.message;
                let errorType = 'Unbekannter Fehler';
                let solutions = [];

                if (e.name === 'AbortError') {
                    errorType = 'Timeout';
                    errorMsg = 'Die Anfrage hat zu lange gedauert (>30 Sekunden)';
                    solutions = [
                        'Pr√ºfe deine Internetverbindung',
                        'Die Datei ist m√∂glicherweise zu gro√ü',
                        'Versuche es erneut - beim zweiten Mal sollte der Browser-Cache helfen'
                    ];
                } else if (e.message.includes('Failed to fetch') || e.message.includes('NetworkError')) {
                    errorType = 'Netzwerkfehler';
                    errorMsg = 'Kann nicht auf die Datei zugreifen';
                    solutions = [
                        '√ñffne die Seite √ºber: <code class="bg-gray-800 px-2 py-1 rounded text-cyan-400">http://localhost:8000</code>',
                        'NICHT per Doppelklick √∂ffnen (file:// funktioniert nicht)',
                        'Stelle sicher, dass der Server l√§uft: <code class="bg-gray-800 px-2 py-1 rounded text-cyan-400">python -m http.server 8000</code>'
                    ];
                } else if (e.message.includes('JSON')) {
                    errorType = 'JSON-Fehler';
                    errorMsg = 'Die Katalog-Datei ist besch√§digt oder ung√ºltig';
                    solutions = [
                        'Die catalog_master.json Datei ist m√∂glicherweise besch√§digt',
                        'Generiere die Datei neu',
                        'Pr√ºfe die Datei auf Syntax-Fehler'
                    ];
                } else {
                    solutions = [
                        '√ñffne die Browser-Konsole (F12) f√ºr Details',
                        'Pr√ºfe ob catalog_master.json im gleichen Ordner ist',
                        'Versuche die Seite neu zu laden'
                    ];
                }

                loadingScreen.innerHTML = `
                    <div class="text-center max-w-3xl p-8">
                        <div class="text-6xl mb-4">‚ùå</div>
                        <h2 class="text-2xl font-bold text-red-400 mb-2">${errorType}</h2>
                        <p class="text-gray-400 mb-6">${errorMsg}</p>
                        
                        <div class="glass rounded-xl p-6 text-left mb-4">
                            <p class="text-sm text-gray-300 mb-3 font-bold">üîç Debug Info:</p>
                            <div class="space-y-1 text-xs font-mono">
                                <p class="text-gray-400">URL: <span class="text-cyan-400">${window.location.href}</span></p>
                                <p class="text-gray-400">Protokoll: <span class="text-cyan-400">${window.location.protocol}</span></p>
                                <p class="text-gray-400">Fehler-Typ: <span class="text-red-400">${e.name}</span></p>
                                <p class="text-gray-400">Nachricht: <span class="text-red-400">${e.message}</span></p>
                            </div>
                        </div>
                        
                        <div class="glass rounded-xl p-6 text-left">
                            <p class="text-sm text-gray-300 mb-3 font-bold">üí° L√∂sungsvorschl√§ge:</p>
                            <ol class="text-sm text-gray-400 list-decimal list-inside space-y-2">
                                ${solutions.map(s => `<li>${s}</li>`).join('')}
                            </ol>
                        </div>
                        
                        <button onclick="location.reload()" class="mt-6 bg-gradient-to-r from-cyan-500 to-purple-500 px-6 py-3 rounded-lg font-bold hover:scale-105 transition-transform">
                            üîÑ Erneut versuchen
                        </button>
                    </div>
                `;
            }
        }

        function updateStatsInfo() {
            if (catalogData && catalogData.statistics) {
                document.getElementById('statsInfo').innerHTML = `
                    <span class="font-bold text-cyan-400">${catalogData.statistics.total_products}</span> Produkte ‚Ä¢
                    <span class="font-bold text-purple-400">${catalogData.statistics.total_brands}</span> Marken
                `;
            }
        }

        // Hero Section
        function renderHero() {
            const stats = catalogData.statistics || {};

            return `
                <div class="relative overflow-hidden bg-gradient-to-br from-gray-900 via-purple-900 to-gray-900 py-20 mb-12 rounded-3xl">
                    <div class="absolute inset-0 bg-grid-pattern opacity-10"></div>
                    <div class="absolute inset-0 bg-gradient-to-t from-gray-900 to-transparent"></div>
                    
                    <div class="relative max-w-6xl mx-auto px-4">
                        <div class="text-center mb-12">
                            <div class="inline-flex items-center gap-2 bg-cyan-500/20 text-cyan-400 px-4 py-2 rounded-full mb-6 border border-cyan-500/30">
                                <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
                                    <path d="M13 10V3L4 14h7v7l9-11h-7z"/>
                                </svg>
                                <span class="text-sm font-semibold">Anleitung</span>
                            </div>
                            <h1 class="text-5xl md:text-7xl font-black mb-6 bg-gradient-to-r from-cyan-400 via-purple-400 to-pink-400 bg-clip-text text-transparent">
                                Naposervices
                            </h1>
                            <p class="text-xl text-gray-300 max-w-2xl mx-auto mb-4">
                                F√ºr Bestellungen der Anleitung folgen!
                            </p>
                            <div class="inline-flex items-center gap-2 bg-orange-500/20 text-orange-400 px-4 py-2 rounded-full border border-orange-500/30">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"></path>
                                </svg>
                                <span class="text-sm font-semibold">Versand: ca. 10‚Ç¨ pro KG</span>
                            </div>
                        </div>

                        <div class="grid md:grid-cols-4 gap-4 max-w-5xl mx-auto">
                            <div class="bg-gray-800/50 backdrop-blur-sm border border-cyan-500/30 rounded-xl p-6 hover:border-cyan-400/50 transition-all group">
                                <div class="w-12 h-12 bg-gradient-to-br from-cyan-500 to-blue-600 rounded-lg flex items-center justify-center mb-4 group-hover:scale-110 transition-transform shadow-lg shadow-cyan-500/50">
                                    <span class="text-2xl font-bold text-white">1</span>
                                </div>
                                <h3 class="text-lg font-bold text-white mb-2">Produkte aussuchen</h3>
                                <p class="text-gray-400 text-sm">
                                    Schau dir unsere Artikel an und notiere die Produktnummern, die dir gefallen.
                                </p>
                            </div>

                            <div class="bg-gray-800/50 backdrop-blur-sm border border-purple-500/30 rounded-xl p-6 hover:border-purple-400/50 transition-all group">
                                <div class="w-12 h-12 bg-gradient-to-br from-purple-500 to-pink-600 rounded-lg flex items-center justify-center mb-4 group-hover:scale-110 transition-transform shadow-lg shadow-purple-500/50">
                                    <span class="text-2xl font-bold text-white">2</span>
                                </div>
                                <h3 class="text-lg font-bold text-white mb-2">Kontakt aufnehmen</h3>
                                <p class="text-gray-400 text-sm">
                                    Schreib uns privat (z.B. per Instagram oder Telegram)
                                </p>
                            </div>

                            <div class="bg-gray-800/50 backdrop-blur-sm border border-pink-500/30 rounded-xl p-6 hover:border-pink-400/50 transition-all group">
                                <div class="w-12 h-12 bg-gradient-to-br from-pink-500 to-rose-600 rounded-lg flex items-center justify-center mb-4 group-hover:scale-110 transition-transform shadow-lg shadow-pink-500/50">
                                    <span class="text-2xl font-bold text-white">3</span>
                                </div>
                                <h3 class="text-lg font-bold text-white mb-2">Produktnummer senden</h3>
                                <p class="text-gray-400 text-sm">
                                    Teile uns die Produktnummer(n) und deine Fragen oder W√ºnsche mit.
                                </p>
                            </div>

                            <div class="bg-gray-800/50 backdrop-blur-sm border border-orange-500/30 rounded-xl p-6 hover:border-orange-400/50 transition-all group">
                                <div class="w-12 h-12 bg-gradient-to-br from-orange-500 to-red-600 rounded-lg flex items-center justify-center mb-4 group-hover:scale-110 transition-transform shadow-lg shadow-orange-500/50">
                                    <span class="text-2xl font-bold text-white">4</span>
                                </div>
                                <h3 class="text-lg font-bold text-white mb-2">Bestellung abschlie√üen</h3>
                                <p class="text-gray-400 text-sm">
                                    Wir best√§tigen Verf√ºgbarkeit, Preis & Versand - und du entscheidest, ob du bestellst.
                                </p>
                            </div>
                        </div>
                        
                        <!-- Social Media Buttons -->
                        <div class="text-center mt-12">
                            <!-- Wichtige Hinweise -->
                            <div class="max-w-4xl mx-auto mb-8 space-y-4">
                                <!-- Preishinweis -->
                                <div class="glass rounded-xl p-4 border border-yellow-500/30">
                                    <div class="flex items-start gap-3">
                                        <div class="flex-shrink-0 w-8 h-8 bg-yellow-500/20 rounded-lg flex items-center justify-center">
                                            <svg class="w-5 h-5 text-yellow-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path>
                                            </svg>
                                        </div>
                                        <div class="text-left flex-1">
                                            <p class="text-sm text-yellow-400 font-bold mb-1">‚ö†Ô∏è Wichtiger Hinweis zu Preisen & Qualit√§t</p>
                                            <p class="text-xs text-gray-300">
                                                Produkte k√∂nnen mehrfach mit unterschiedlichen Preisen vorkommen, da wir mit verschiedenen Sellern arbeiten. 
                                                <span class="text-yellow-400 font-semibold">G√ºnstigere Alternativen sind oft weniger hochwertig.</span> 
                                                F√ºr detaillierte Infos zu Qualit√§tsunterschieden kontaktiere uns per Instagram oder Telegram.
                                            </p>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Farbvarianten Hinweis -->
                                <div class="glass rounded-xl p-4 border border-purple-500/30">
                                    <div class="flex items-start gap-3">
                                        <div class="flex-shrink-0 w-8 h-8 bg-purple-500/20 rounded-lg flex items-center justify-center">
                                            <svg class="w-5 h-5 text-purple-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01"></path>
                                            </svg>
                                        </div>
                                        <div class="text-left flex-1">
                                            <p class="text-sm text-purple-400 font-bold mb-1">üé® Weitere Farbvarianten verf√ºgbar</p>
                                            <p class="text-xs text-gray-300">
                                                Hinter den Produktbildern k√∂nnen sich weitere Farbvarianten verbergen. 
                                                <span class="text-purple-400 font-semibold">Frag uns nach allen verf√ºgbaren Farben!</span>
                                            </p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <p class="text-gray-400 mb-4 text-sm font-semibold">üì± Kontaktiere uns f√ºr Bestellungen & Fragen:</p>
                            <div class="flex gap-4 justify-center mb-8">
                                <!-- Instagram Button -->
                                <a href="https://instagram.com/napo.services" target="_blank" rel="noopener noreferrer" class="group glass px-6 py-3 rounded-xl hover-glow transition-all hover:scale-105 flex items-center gap-3">
                                    <div class="w-10 h-10 bg-gradient-to-br from-purple-500 via-pink-500 to-orange-500 rounded-lg flex items-center justify-center group-hover:scale-110 transition-transform shadow-lg">
                                        <svg class="w-6 h-6 text-white" fill="currentColor" viewBox="0 0 24 24">
                                            <path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/>
                                        </svg>
                                    </div>
                                    <span class="font-bold text-white group-hover:text-pink-400 transition-colors">Instagram</span>
                                </a>
                                
                                <!-- Telegram Button -->
                                <a href="https://t.me/naposervices" target="_blank" rel="noopener noreferrer" class="group glass px-6 py-3 rounded-xl hover-glow transition-all hover:scale-105 flex items-center gap-3">
                                    <div class="w-10 h-10 bg-gradient-to-br from-cyan-500 to-blue-500 rounded-lg flex items-center justify-center group-hover:scale-110 transition-transform shadow-lg">
                                        <svg class="w-6 h-6 text-white" fill="currentColor" viewBox="0 0 24 24">
                                            <path d="M11.944 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0a12 12 0 0 0-.056 0zm4.962 7.224c.1-.002.321.023.465.14a.506.506 0 0 1 .171.325c.016.093.036.306.02.472-.18 1.898-.962 6.502-1.36 8.627-.168.9-.499 1.201-.82 1.23-.696.065-1.225-.46-1.9-.902-1.056-.693-1.653-1.124-2.678-1.8-1.185-.78-.417-1.21.258-1.91.177-.184 3.247-2.977 3.307-3.23.007-.032.014-.15-.056-.212s-.174-.041-.249-.024c-.106.024-1.793 1.14-5.061 3.345-.48.33-.913.49-1.302.48-.428-.008-1.252-.241-1.865-.44-.752-.245-1.349-.374-1.297-.789.027-.216.325-.437.893-.663 3.498-1.524 5.83-2.529 6.998-3.014 3.332-1.386 4.025-1.627 4.476-1.635z"/>
                                        </svg>
                                    </div>
                                    <span class="font-bold text-white group-hover:text-cyan-400 transition-colors">Telegram</span>
                                </a>
                            </div>
                            
                            <button onclick="window.scrollTo({ top: 600, behavior: 'smooth' })" class="bg-gradient-to-r from-cyan-500 to-purple-500 hover:from-cyan-400 hover:to-purple-400 text-white px-8 py-4 rounded-xl font-bold text-lg shadow-2xl shadow-cyan-500/50 hover:scale-105 transition-transform">
                                Jetzt st√∂bern
                            </button>
                        </div>
                    </div>
                </div>
            `;
        }

        // Main Categories (Kleidung/Schuhe)
        function renderMainCategories() {
            let html = renderHero();
            html += `
                <div class="max-w-7xl mx-auto">
                    <h2 class="text-4xl font-black mb-8">
                        <span class="bg-gradient-to-r from-cyan-400 to-purple-400 bg-clip-text text-transparent">
                            Kategorien
                        </span>
                    </h2>
                    <div class="grid md:grid-cols-2 gap-8">
            `;

            for (const [mainCat, brands] of Object.entries(catalogData.categories)) {
                const brandCount = Object.keys(brands).length;
                const productCount = Object.values(brands).reduce((sum, products) => sum + products.length, 0);
                const icon = mainCat === 'Kleidung'
                    ? '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"></path>'
                    : '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"></path>';

                html += `
                    <div onclick="selectMainCategory('${mainCat}')" class="group glass rounded-2xl p-8 hover-glow cursor-pointer transition-all">
                        <div class="flex items-start justify-between mb-6">
                            <div class="w-16 h-16 bg-gradient-to-br from-cyan-500 to-purple-500 rounded-xl flex items-center justify-center group-hover:scale-110 transition-transform shadow-lg">
                                <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">${icon}</svg>
                            </div>
                            <svg class="w-10 h-10 text-cyan-400 group-hover:translate-x-2 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                            </svg>
                        </div>
                        <h2 class="text-3xl font-black text-white mb-3 group-hover:text-cyan-400 transition-colors">
                            ${mainCat}
                        </h2>
                        <p class="text-gray-400 text-lg">
                            ${brandCount} Marken ‚Ä¢ ${productCount} Produkte
                        </p>
                    </div>
                `;
            }

            html += `</div></div>`;
            return html;
        }

        // Brands View
        function renderBrands() {
            const brands = catalogData.categories[currentState.selectedMainCategory];

            let html = `
                <div class="max-w-7xl mx-auto">
                    <button onclick="showView('categories')" class="mb-8 text-cyan-400 hover:text-cyan-300 flex items-center group">
                        <svg class="w-5 h-5 mr-2 group-hover:-translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                        </svg>
                        <span class="font-semibold">Zur√ºck</span>
                    </button>
                    
                    <h1 class="text-5xl font-black bg-gradient-to-r from-cyan-400 to-purple-400 bg-clip-text text-transparent mb-3">
                        ${currentState.selectedMainCategory}
                    </h1>
                    <p class="text-gray-400 mb-12 text-lg">${Object.keys(brands).length} Marken verf√ºgbar</p>
                    
                    <div class="grid md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4">
            `;

            for (const [brandName, products] of Object.entries(brands).sort()) {
                html += `
                    <div onclick="selectBrand('${brandName}')" class="group glass rounded-xl p-6 hover-glow cursor-pointer text-center transition-all">
                        <h3 class="text-xl font-bold text-white mb-2 group-hover:text-purple-400 transition-colors">
                            ${brandName.replace(/_/g, ' ')}
                        </h3>
                        <p class="text-sm text-gray-500">${products.length} Produkte</p>
                    </div>
                `;
            }

            html += `</div></div>`;
            return html;
        }

        // Products View
        function renderProducts() {
            const allProducts = catalogData.categories[currentState.selectedMainCategory][currentState.selectedBrand];
            
            // Zeige nur die ersten X Produkte (Pagination)
            const maxProducts = currentState.currentPage * currentState.productsPerPage;
            const products = allProducts.slice(0, maxProducts);
            const hasMore = allProducts.length > maxProducts;

            let html = `
                <div class="max-w-7xl mx-auto">
                    <button onclick="showView('brands')" class="mb-8 text-cyan-400 hover:text-cyan-300 flex items-center group">
                        <svg class="w-5 h-5 mr-2 group-hover:-translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                        </svg>
                        <span class="font-semibold">Zur√ºck zu Marken</span>
                    </button>
                    
                    <div class="mb-12">
                        <h1 class="text-5xl font-black bg-gradient-to-r from-cyan-400 to-purple-400 bg-clip-text text-transparent mb-2">
                            ${currentState.selectedBrand.replace(/_/g, ' ')}
                        </h1>
                        <p class="text-gray-400 text-lg">${allProducts.length} Premium Produkte ${products.length < allProducts.length ? `(${products.length} angezeigt)` : ''}</p>
                    </div>
                    
                    <div class="grid md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4" id="productsGrid">
            `;

            products.forEach((product, idx) => {
                // Sichere Produkt-Daten mit Null-Checks
                const safeProduct = {
                    ...product,
                    images: product.images || [],
                    thumbnail: product.thumbnail || '',
                    product_number: product.product_number || `#${product.id}`,
                    price_euro: product.price_euro || '‚Äî',
                    category: product.category || 'Unbekannt'
                };

                // Sicheres Encoding f√ºr JSON im HTML
                const productJson = encodeURIComponent(JSON.stringify(safeProduct));

                html += `
                    <div class="group glass rounded-xl overflow-hidden hover-glow transition-all">
                        <div class="relative image-container cursor-pointer overflow-hidden h-48 bg-gray-800" onclick='openGallery(decodeURIComponent("${productJson}")); event.stopPropagation();'>
                            <!-- Blur Placeholder f√ºr schnelleres Laden -->
                            <div class="absolute inset-0 bg-gradient-to-br from-gray-700 to-gray-800 animate-pulse"></div>
                            <img 
                                data-src="${safeProduct.thumbnail}" 
                                alt="${safeProduct.product_number}"
                                class="lazy-image w-full h-full object-cover group-hover:scale-110 transition-transform duration-500 relative z-10"
                                data-loading="true"
                                loading="lazy"
                                decoding="async"
                                onerror="this.src='data:image/svg+xml,%3Csvg xmlns=\\'http://www.w3.org/2000/svg\\' width=\\'400\\' height=\\'300\\'%3E%3Crect fill=\\'%23374151\\' width=\\'400\\' height=\\'300\\'/%3E%3Ctext x=\\'50%25\\' y=\\'50%25\\' fill=\\'%239CA3AF\\' text-anchor=\\'middle\\' dy=\\'.3em\\' font-size=\\'14\\'%3EBild nicht verf√ºgbar%3C/text%3E%3C/svg%3E'"
                            >
                            <div class="absolute inset-0 bg-gradient-to-t from-black/80 to-transparent opacity-0 group-hover:opacity-100 transition-opacity">
                                <div class="absolute bottom-2 left-2 right-2">
                                    <p class="text-white font-bold text-xs">Klicken zum √ñffnen</p>
                                </div>
                            </div>
                            <div class="absolute top-2 right-2 glass px-2 py-1 rounded-full text-xs font-bold text-cyan-400 border border-cyan-500/50">
                                ${safeProduct.images?.length || 0}
                            </div>
                        </div>
                        
                        <div class="p-3">
                            <p class="text-xs text-cyan-400 font-bold mb-2">${safeProduct.product_number}</p>
                            <div class="flex items-center justify-center">
                                <p class="text-lg font-black bg-gradient-to-r from-cyan-400 to-purple-400 bg-clip-text text-transparent">
                                    ‚Ç¨${safeProduct.price_euro}
                                </p>
                            </div>
                        </div>
                    </div>
                `;
            });

            html += `</div>`;
            
            // "Mehr laden" Button wenn noch Produkte vorhanden
            if (hasMore) {
                html += `
                    <div class="text-center mt-12">
                        <button onclick="loadMoreProducts()" class="glass px-8 py-4 rounded-xl font-bold text-lg hover-glow transition-all hover:scale-105 border border-cyan-500/50">
                            <span class="bg-gradient-to-r from-cyan-400 to-purple-400 bg-clip-text text-transparent">
                                Mehr laden (${allProducts.length - products.length} weitere)
                            </span>
                        </button>
                    </div>
                `;
            }
            
            html += `</div>`;

            // Setup lazy loading after render
            setTimeout(() => {
                document.querySelectorAll('.lazy-image').forEach(img => {
                    if (img.dataset.src) {
                        img.src = img.dataset.src;
                        imageObserver.observe(img);
                    }
                });
            }, 100);

            return html;
        }

        // View Management
        function showView(view) {
            currentState.view = view;
            if (view === 'categories') {
                currentState.selectedMainCategory = null;
                currentState.selectedBrand = null;
            } else if (view === 'brands') {
                currentState.selectedBrand = null;
            }
            render();
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function selectMainCategory(mainCat) {
            currentState.selectedMainCategory = mainCat;
            currentState.view = 'brands';
            render();
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function selectBrand(brand) {
            currentState.selectedBrand = brand;
            currentState.view = 'products';
            currentState.currentPage = 1; // Reset pagination
            render();
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
        
        function loadMoreProducts() {
            currentState.currentPage++;
            render();
            // Scroll zu den neuen Produkten
            setTimeout(() => {
                const grid = document.getElementById('productsGrid');
                if (grid) {
                    const newProducts = grid.children[grid.children.length - currentState.productsPerPage];
                    if (newProducts) {
                        newProducts.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    }
                }
            }, 100);
        }

        function render() {
            const mainContent = document.getElementById('mainContent');

            switch (currentState.view) {
                case 'home':
                case 'categories':
                    mainContent.innerHTML = renderMainCategories();
                    break;
                case 'brands':
                    mainContent.innerHTML = renderBrands();
                    break;
                case 'products':
                    mainContent.innerHTML = renderProducts();
                    break;
            }
        }

        // Gallery Functions
        function openGallery(productData) {
            // Wenn String, dann ist es encoded JSON
            let product = productData;
            if (typeof productData === 'string') {
                try {
                    product = JSON.parse(productData);
                } catch (e) {
                    console.error('Fehler beim Parsen der Produktdaten:', e);
                    return;
                }
            }

            // Sicherheitspr√ºfung
            if (!product || !product.images || product.images.length === 0) {
                console.error('Ung√ºltige Produktdaten:', product);
                showToast('‚ùå Keine Bilder verf√ºgbar');
                return;
            }

            currentState.selectedProduct = product;
            currentState.currentImageIndex = 0;

            const modal = document.getElementById('galleryModal');
            modal.classList.remove('hidden');
            modal.classList.add('flex');
            
            // WICHTIG: Verhindere Body-Scroll wenn Modal offen ist
            document.body.style.overflow = 'hidden';

            updateGalleryContent();

            // Preload next/prev images
            preloadGalleryImages();
        }

        function closeGallery() {
            const modal = document.getElementById('galleryModal');
            modal.classList.add('hidden');
            modal.classList.remove('flex');
            
            // WICHTIG: Erlaube Body-Scroll wieder
            document.body.style.overflow = 'auto';
        }

        function nextImage() {
            if (currentState.selectedProduct) {
                currentState.currentImageIndex =
                    (currentState.currentImageIndex + 1) % currentState.selectedProduct.images.length;
                updateGalleryContent();
                preloadGalleryImages();
            }
        }

        function prevImage() {
            if (currentState.selectedProduct) {
                currentState.currentImageIndex =
                    currentState.currentImageIndex === 0
                        ? currentState.selectedProduct.images.length - 1
                        : currentState.currentImageIndex - 1;
                updateGalleryContent();
                preloadGalleryImages();
            }
        }

        function preloadGalleryImages() {
            // Preload next and previous images
            const product = currentState.selectedProduct;
            const idx = currentState.currentImageIndex;

            const nextIdx = (idx + 1) % product.images.length;
            const prevIdx = idx === 0 ? product.images.length - 1 : idx - 1;

            [nextIdx, prevIdx].forEach(i => {
                const img = new Image();
                img.src = product.images[i];
            });
        }

        function selectThumbnail(index) {
            currentState.currentImageIndex = index;
            updateGalleryContent();
            preloadGalleryImages();

            // Scroll thumbnail into view
            setTimeout(() => {
                const thumbnail = document.querySelector(`[data-thumb-index="${index}"]`);
                if (thumbnail) {
                    thumbnail.scrollIntoView({ behavior: 'smooth', block: 'nearest', inline: 'center' });
                }
            }, 50);
        }

        function updateGalleryContent() {
            const product = currentState.selectedProduct;
            if (!product || !product.images || product.images.length === 0) {
                console.error('Keine Produktdaten verf√ºgbar');
                return;
            }

            const idx = currentState.currentImageIndex;

            // Sichere Produkt-Daten
            const safeProduct = {
                product_number: product.product_number || `#${product.id || '?'}`,
                category: product.category || 'Unbekannt',
                price_euro: product.price_euro || '‚Äî',
                images: product.images || []
            };

            let html = `
                <div class="w-full max-w-6xl mx-auto">
                    <!-- Hauptbild -->
                    <div class="relative w-full flex justify-center mb-4">
                        <div class="image-container loading w-full max-w-4xl">
                            <img 
                                src="${product.images[idx]}" 
                                alt="${product.name} ${idx + 1}" 
                                class="max-w-full max-h-[60vh] w-auto mx-auto object-contain rounded-xl"
                                onload="this.parentElement.classList.remove('loading')"
                                onerror="this.src='data:image/svg+xml,%3Csvg xmlns=\\'http://www.w3.org/2000/svg\\' width=\\'800\\' height=\\'600\\'%3E%3Crect fill=\\'%23374151\\' width=\\'800\\' height=\\'600\\'/%3E%3Ctext x=\\'50%25\\' y=\\'50%25\\' fill=\\'%239CA3AF\\' text-anchor=\\'middle\\' dy=\\'.3em\\' font-size=\\'24\\'%3EBild nicht verf√ºgbar%3C/text%3E%3C/svg%3E'; this.parentElement.classList.remove('loading');"
                            >
                        </div>
                    </div>
                    
                    <!-- Produkt Info -->
                    <div class="text-center glass rounded-xl p-4 mb-4 mx-auto max-w-2xl">
                        <p class="text-xl text-cyan-400 font-black mb-2">${safeProduct.product_number}</p>
                        <p class="text-sm text-gray-400 mb-2">${safeProduct.category.replace(/_/g, ' ')}</p>
                        <div class="flex items-center justify-center gap-4 mb-2">
                            <p class="text-2xl font-black bg-gradient-to-r from-cyan-400 to-purple-400 bg-clip-text text-transparent">
                                ‚Ç¨${safeProduct.price_euro}
                            </p>
                            <p class="text-sm text-gray-400">Bild ${idx + 1}/${safeProduct.images.length}</p>
                        </div>
                        <p class="text-xs text-gray-500 mb-2">üì¶ Versand: ca. 10‚Ç¨/KG</p>
                        <div class="inline-flex items-center gap-2 bg-purple-500/10 border border-purple-500/30 px-3 py-1 rounded-full">
                            <svg class="w-3 h-3 text-purple-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01"></path>
                            </svg>
                            <p class="text-xs text-purple-400 font-semibold">Weitere Farben verf√ºgbar? Frag uns!</p>
                        </div>
                    </div>
                    
                    <!-- Thumbnail Navigation - DEUTLICH SICHTBAR -->
                    ${safeProduct.images.length > 1 ? (() => {
                    const startIdx = Math.max(0, Math.min(idx - 2, safeProduct.images.length - 5));
                    const endIdx = Math.min(startIdx + 5, safeProduct.images.length);
                    const visibleImages = safeProduct.images.slice(startIdx, endIdx);
                    const canScrollLeft = startIdx > 0;
                    const canScrollRight = endIdx < safeProduct.images.length;

                    let thumbHtml = `
                            <div class="glass rounded-xl p-3 sm:p-4 mx-2 sm:mx-auto max-w-3xl">
                                <p class="text-center text-xs sm:text-sm text-gray-400 mb-2 sm:mb-3 font-semibold">Weitere Bilder:</p>
                                <div class="flex items-center justify-center gap-1 sm:gap-2">
                        `;

                    // Linker Pfeil
                    if (canScrollLeft) {
                        thumbHtml += `
                                <button onclick="selectThumbnail(${startIdx - 1})" class="bg-cyan-500/20 hover:bg-cyan-500/40 p-2 sm:p-3 rounded-lg transition-all flex-shrink-0 border border-cyan-500/50">
                                    <svg class="w-5 h-5 sm:w-6 sm:h-6 text-cyan-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M15 19l-7-7 7-7"></path>
                                    </svg>
                                </button>
                            `;
                    } else {
                        thumbHtml += '<div class="w-9 sm:w-12"></div>';
                    }

                    // Thumbnails - MOBILE OPTIMIERT
                    thumbHtml += '<div class="flex gap-2 sm:gap-3 justify-center items-center overflow-x-auto">';

                    visibleImages.forEach((img, i) => {
                        const actualIdx = startIdx + i;
                        const isActive = actualIdx === idx;

                        thumbHtml += `
                                <div class="flex-shrink-0">
                                    <img 
                                        src="${img}"
                                        alt="Bild ${actualIdx + 1}" 
                                        onclick="selectThumbnail(${actualIdx})" 
                                        class="w-16 h-16 sm:w-20 sm:h-20 md:w-24 md:h-24 object-cover rounded-lg cursor-pointer transition-all ${isActive
                                ? 'border-4 border-cyan-400 ring-4 ring-cyan-500/50 scale-105 opacity-100 shadow-xl shadow-cyan-500/50'
                                : 'border-3 border-gray-600 opacity-70 hover:opacity-100 hover:scale-105 hover:border-cyan-400'
                            }"
                                        style="border-width: ${isActive ? '4px' : '3px'}; min-width: 64px; min-height: 64px;"
                                        onerror="this.style.display='none'"
                                    >
                                </div>
                            `;
                    });

                    thumbHtml += '</div>';

                    // Rechter Pfeil
                    if (canScrollRight) {
                        thumbHtml += `
                                <button onclick="selectThumbnail(${endIdx})" class="bg-cyan-500/20 hover:bg-cyan-500/40 p-2 sm:p-3 rounded-lg transition-all flex-shrink-0 border border-cyan-500/50">
                                    <svg class="w-5 h-5 sm:w-6 sm:h-6 text-cyan-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M9 5l7 7-7 7"></path>
                                    </svg>
                                </button>
                            `;
                    } else {
                        thumbHtml += '<div class="w-9 sm:w-12"></div>';
                    }

                    thumbHtml += `
                                </div>
                            </div>
                        `;

                    return thumbHtml;
                })() : ''}
                </div>
            `;

            document.getElementById('galleryContent').innerHTML = html;
        }

        // Keyboard Navigation
        document.addEventListener('keydown', (e) => {
            const modal = document.getElementById('galleryModal');
            if (!modal.classList.contains('hidden')) {
                if (e.key === 'ArrowLeft') {
                    prevImage();
                } else if (e.key === 'ArrowRight') {
                    nextImage();
                } else if (e.key === 'Escape') {
                    closeGallery();
                }
            }
        });

        // Initial load
        loadCatalog();
    </script>
</body>

</html>